import java.nio.file.Paths

plugins {
    // Apply the java plugin to add support for Java
    id 'java'
}
version '1.0'

repositories {
    jcenter()
}

sourceSets {
    media {
        java.srcDirs = ['media/lua', 'media/scripts']
        resources.srcDirs = ['media/sound', 'media/textures']
    }
}

Properties properties = new Properties()
def propertiesFile = project.rootProject.file('local.properties')
if (propertiesFile.exists()) {
    properties.load(propertiesFile.newDataInputStream())
}
project.ext.ideaHome = properties.getProperty('idea.home', '')
project.ext.gameDir = Paths.get(properties.getProperty('game.dir', ''))

if (project.ext.gameDir == null)
{
    if (providers.environmentVariable('GAME_DIR').present) {
        project.ext.gameDir = Paths.get(providers.environmentVariable('GAME_DIR').get())
    }
    else if (System.hasProperty('game.dir')) {
        project.ext.gameDir = Paths.get(System.getProperty('game.dir'))
    }
    else throw new RuntimeException("Game directory path not specified")
}

apply from: 'utils.gradle'
apply from: 'zomboid.gradle'
apply from: 'zdoc.gradle'
apply from: 'mod.gradle'

jar {
    from sourceSets.media.output
}
